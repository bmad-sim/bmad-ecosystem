# File generated by: write_lattice_in_foreign_format
# Bmad lattice file: write_foreign_test.bmad

using Beamlines


function map_match1(v, q)
  v_out1= 
      1.5650E+00*v[1] +
     -7.3485E-02*v[2] +
      3.5194E-01*v[3] +
     -3.8271E-02*v[4]                                                                                                                                                                                   
  v_out2= 
      7.3485E-02*v[1] +
      6.8042E-01*v[2] +
      3.3143E-02*v[3] +
     -2.0320E-01*v[4]                                                                                                                                                                                   
  v_out3= 
      3.5194E-01*v[1] +
     -3.3143E-02*v[2] +
      1.1997E+00*v[3] +
     -5.6569E-02*v[4]                                                                                                                                                                                   
  v_out4= 
      3.8271E-02*v[1] +
     -2.0320E-01*v[2] +
      5.6569E-02*v[3] +
      8.8940E-01*v[4]                                                                                                                                                                                   
  v_out5= 
     -2.5770E-01 +
      1.0000E+00*v[5] +
     -6.7290E-02*v[6]                                                                                                                                                                                   
  v_out6= 
      1.0000E+00*v[6]                                                                                                                                                                                   

  q_out0 = 0.0
  q_out1 = 0.0
  q_out2 = 0.0
  q_out3 = 0.0

  return (v_out1, v_out2, v_out3, v_out4, v_out5, v_out6), (q_out1, q_out2, q_out3, q_out4)
end

function map_taylor1(v, q)
  v_out1= 
      1.0045E+00*v[1] +
     -9.5488E-03 +
      8.8121E+00*v[2] +
      3.1589E-06*v[3] +
      6.2474E-07*v[4] +
     -7.9443E-04*v[5] +
     -1.5990E-03*v[6] +
     -1.8689E-01*v[1]^2 +
     -4.4999E-08*v[1]*v[4] +
      2.2651E-06*v[2]*v[4] +
      7.3789E-02*v[3]*v[4] +
      7.4850E-03*v[4]^2 +
      8.2601E-04*v[5]^2 +
     -2.8822E-03*v[1]*v[6] +
     -5.8123E+00*v[2]*v[6] +
     -2.2659E-06*v[3]*v[6] +
     -1.0735E-06*v[4]*v[6] +
     -2.5978E-05*v[5]*v[6] +
      1.5991E-03*v[6]^2                                                                                                                                                                                 
  v_out2= 
      1.0001E+00*v[2] +
      2.7502E-04 +
      5.1708E-04*v[1] +
      3.6672E-07*v[3] +
      7.2562E-08*v[4] +
     -8.2467E-04*v[2]^2 +
      2.1696E-02*v[3]^2 +
     -1.6689E-08*v[1]*v[4] +
     -1.0055E-07*v[2]*v[4] +
      8.5657E-03*v[3]*v[4] +
      8.7607E-04*v[4]^2 +
      1.5387E-06*v[1]*v[5] +
      2.9709E-03*v[2]*v[5] +
     -7.7464E-08*v[4]*v[6] +
     -8.1698E-07*v[5]*v[6] +
      2.8870E-08*v[6]^2                                                                                                                                                                                 
  v_out3= 
      1.0000E+00*v[3] +
      3.2611E-05 +
     -8.4879E-06*v[5] +
     -1.6296E-05*v[6] +
      5.2306E-08*v[1]*v[2] +
      9.9263E-07*v[2]^2 +
      3.7378E-01*v[1]*v[3] +
      7.3779E-02*v[2]*v[3] +
      7.3718E-02*v[1]*v[4] +
      1.4552E-02*v[2]*v[4] +
     -1.4099E-03*v[3]*v[5] +
     -3.0176E+00*v[4]*v[5] +
      8.4155E-06*v[5]^2 +
     -2.2655E-06*v[1]*v[6] +
     -1.0704E-06*v[2]*v[6] +
      2.8827E-03*v[3]*v[6] +
     -5.8094E+00*v[4]*v[6] +
      1.1948E-07*v[5]*v[6]                                                                                                                                                                              
  v_out4= 
      9.9990E-01*v[4] +
     -5.1721E-04*v[3] +
      8.3316E-09*v[5] +
     -7.3755E-08*v[2]^2 +
     -1.6489E-08*v[3]*v[4] +
     -1.7426E-07*v[4]^2 +
     -1.5336E-06*v[3]*v[5] +
      2.9703E-03*v[4]*v[5] +
     -2.4062E-08*v[1]*v[6] +
     -7.7039E-08*v[2]*v[6] +
     -2.3150E-06*v[3]*v[6] +
      1.0238E-04*v[4]*v[6]                                                                                                                                                                              
  v_out5= 
      1.0000E+00*v[5] +
     -8.6214E-05 +
     -7.9768E-07*v[1] +
     -1.5989E-03*v[2] +
      7.5743E-09*v[3] +
     -3.4279E-05*v[3]^2 +
     -2.1930E-06*v[1]*v[4] +
     -8.1289E-07*v[2]*v[4] +
      2.8891E-03*v[3]*v[4] +
     -2.9049E+00*v[4]^2 +
      8.0460E-07*v[1]*v[5] +
     -2.3619E-05*v[2]*v[5] +
      1.4526E-07*v[4]*v[5] +
      1.4504E-08*v[5]*v[6] +
     -7.4137E-07*v[6]^2                                                                                                                                                                                 
  v_out6= 
      1.0000E+00*v[6] +
     -7.5702E-06 +
      1.2266E-06*v[1] +
      7.9221E-04*v[2] +
      4.2434E-09*v[3] +
      8.4636E-06*v[4] +
      5.9409E-03*v[5] +
      3.6954E-07*v[1]*v[3] +
      1.1766E-06*v[2]*v[3] +
      1.6057E-05*v[3]^2 +
      1.1766E-06*v[1]*v[4] +
      4.7829E-07*v[2]*v[4] +
      1.4203E-03*v[3]*v[4] +
      1.5045E+00*v[4]^2 +
     -5.3002E-07*v[1]*v[5] +
      3.2952E-05*v[2]*v[6] +
     -4.6831E-08*v[4]*v[6]                                                                                                                                                                              

  q_out0 = 
      6.00000E-01                                                                                                                                                                                       
  q_out1 = 
      7.00000E-01                                                                                                                                                                                       
  q_out2 = 
      8.00000E-01                                                                                                                                                                                       
  q_out3 = 
      2.30000E-01*q[1]*q[3]^2                                                                                                                                                                           

  return (v_out1, v_out2, v_out3, v_out4, v_out5, v_out6), (q_out1, q_out2, q_out3, q_out4)
end

@eles begin
  ab_multipole1 = Multipole(Ks2L =   2.0000E+02, Kn2L =   2.0000E+02, z_rot =   1.0000E-01)
  ac_kicker0123456789 = ACKicker(L =   3.0000E-01, Kn0 =  -3.3333E-02)
  ac_kicker2 = ACKicker(L =   4.0000E-01, Ks0 =   2.5000E-02)
  beambeam1 = BeamBeam(x_offset =   3.0000E-03, y_offset =   3.0000E-03, x_rot =   5.0000E-02,
   ksol =   1.0000E+00)
  crab_cavity1 = CrabCavity(L =   2.0000E-01, rf_frequency =   1.0000E+08, voltage =   1.0000E+03,
   phi0 =  -2.0000E-01)
  ecollimator1 = Drift(L =   4.5000E+00, Ks0 =   2.2037E-04, Kn0 =  -2.2555E-03, x1_limit =  -2.0000E-01,
   x2_limit =   2.0000E-01, y1_limit =  -1.0000E-01, y2_limit =   1.0000E-01, x_offset =   2.0000E-02,
   x_rot =   1.0000E-03, z_rot =   1.0000E-01)
  elseparator1 = ELSeparator(L =   4.5000E+00, En0 =  -9.5509E+02, x_offset =   5.0000E-02,
   x_rot =   1.0000E-03, z_rot =   1.0000E-01)
  elseparator2 = ELSeparator(L =   4.5000E+00, Es0 =   9.5509E+02, x_offset =   5.0000E-02,
   x_rot =   1.0000E-03, z_rot =   1.0000E-01)
  em_field1 = EMField(L =   1.4000E+00)
  em_field2 = EMField(L =   1.4000E+00)
  fiducial1 = Fiducial()
  floor_shift1 = FloorShift(x_offset =   1.0000E-01, y_offset =   2.0000E-01, z_offset =   3.0000E-01,
   x_rot =   2.0000E-02, y_rot =  -1.0000E-02, z_rot =   4.0000E-01)
  gkicker1 = Kicker()
  hkicker1 = Kicker(L =   4.5000E+00, Kn0 =  -1.1111E-03, x_offset =   5.0000E-02, x_rot =   1.0000E-03,
   z_rot =   1.0000E-01)
  instrument1 = Drift(L =   4.5000E+00)
  kicker1 = Kicker(L =   4.5000E+00, Ks0 =   6.6667E-04, Kn0 =   1.3333E-06, x_offset =   5.0000E-02,
   x_rot =   1.0000E-03, z_rot =   1.0000E-01)
  match1 = LineElement(transport_map = map_match1)
  monitor1 = Drift(L =   4.5000E+00)
  multipole1 = Multipole(Ks1L =  -1.0000E+00, Kn1L =   6.1232E-17, Ks3L =   3.0805E+00,
   Kn3L =  -3.2804E+00)
  octupole1 = Octupole(L =   4.5000E+00, Kn3 =   1.0000E+03, x_offset =   1.0000E-02,
   x_rot =   1.0000E-03, z_rot =   3.9270E-01)
  patch1 = Patch(L =   4.0050E-03, dt =   1.0000E-11, dx =   1.0000E-03, dy =   2.0000E-03,
   dz =   4.0000E-03, dx_rot =   2.0000E-03, dy_rot =  -1.0000E-03, dz_rot =   2.0000E+00)
  quadrupole1 = Quadrupole(L =   6.0000E-01, Ks0 =   9.8821E-03, Kn0 =   1.1785E-04, Ks1 =   1.0000E-01,
   Kn1 =   1.0000E+00, En0 =  -2.0000E+03, Es1 =   2.0000E+04, x_offset =   5.0000E-02,
   x_rot =   1.0000E-03, z_rot =   7.8540E-01)
  quadrupole2 = Quadrupole(L =   6.0000E-01, Ks0 =  -1.0118E-02, Kn0 =   1.1785E-04, Ks1 =  -1.0000E-01,
   Kn1 =  -1.0000E+00, En0 =  -2.0000E+03, Es1 =   2.0000E+04, x_offset =   5.0000E-02,
   x_rot =   1.0000E-03, z_rot =   7.8540E-01)
  quadrupole3 = Quadrupole(L =   6.0000E-01, Ks0 =  -1.1785E-04, Kn0 =   1.1785E-04, Ks1 =   1.0000E-21,
   Kn1 =   1.0000E-20, En0 =  -2.0000E+03, Es1 =   2.0000E+04, x_offset =   5.0000E-02,
   x_rot =   1.0000E-03, z_rot =   7.8540E-01)
  quadrupole4 = Quadrupole(L =   6.0000E-01, Ks0 =   9.8821E-03, Kn0 =   1.1785E-04, Ks1 =   1.0000E-01,
   Kn1 =   1.0000E+00, En0 =  -2.0000E+03, Es1 =   2.0000E+04, x_offset =   5.0000E-02,
   x_rot =   1.0000E-03, z_rot =   7.8540E-01)
  quadrupole5 = Quadrupole(L =   6.0000E-01, Ks0 =  -1.0118E-02, Kn0 =   1.1785E-04, Ks1 =  -1.0000E-01,
   Kn1 =  -1.0000E+00, En0 =  -2.0000E+03, Es1 =   2.0000E+04, x_offset =   5.0000E-02,
   x_rot =   1.0000E-03, z_rot =   7.8540E-01)
  rcollimator1 = Drift(L =   4.5000E+00, x1_limit =  -2.0000E-01, x2_limit =   2.0000E-01,
   y1_limit =  -1.0000E-01, y2_limit =   1.0000E-01, x_offset =   2.0000E-02, x_rot =   1.0000E-03,
   z_rot =   1.0000E-01)
  rfcavity1 = RFCavity(L =   4.5000E+00, x_offset =   5.0000E-02, x_rot =   1.0000E-03,
   z_rot =   1.0000E-01, zero_phase = PhaseReference.AboveTransition, rf_frequency =   5.0000E+08,
   voltage =   1.0000E+05, phi0 =   1.0000E-01)
  rfcavity2 = RFCavity(L =   4.5000E+00, x_offset =   5.0000E-02, x_rot =   1.0000E-03,
   z_rot =   1.0000E-01, zero_phase = PhaseReference.AboveTransition, rf_frequency =   5.0000E+08,
   voltage =   1.0000E+05, phi0 =   1.0000E-01)
  rfcavity3 = RFCavity(x_offset =   5.0000E-02, x_rot =   1.0000E-03, z_rot =   1.0000E-01,
   zero_phase = PhaseReference.AboveTransition, rf_frequency =   5.0000E+08, voltage =   1.0000E+05,
   phi0 =   1.0000E-01)
  sad_mult1 = SadMult(L =   1.0000E-01, Ks1 =   2.0000E-01, Kn2 =   8.0000E+02, Ks10 =   3.6288E+27,
   ksol =   5.0000E-01)
  sad_mult2 = SadMult(Ks1L =   2.0000E-02, Kn2L =   8.0000E+01, Ks10L =   3.6288E+26,
   ksol =   5.0000E-01)
  sbend1 = SBend(L =   6.0000E-01, tilt_ref =   1.0000E-01, Ks0 =  -1.6583E-04, Kn0 =   1.6639E-05,
   Kn1 =   3.0000E-01, En0 =  -2.0000E+03, Es1 =   6.6667E+03, x_offset =   5.0000E-02,
   x_rot =   1.0000E-03)
  rbend2 = SBend(bend_type = rbend, L_chord =   6.0000E-01, tilt_ref =   1.0000E-01, Ks0 =  -1.6583E-04,
   Kn0 =   1.6639E-05, Kn2 =   3.0000E+00, En0 =  -2.0000E+03, Es1 =   6.6667E+03, x_offset =   5.0000E-02,
   x_rot =   1.0000E-03)
  sbend3 = SBend(L =   6.0000E-01, tilt_ref =   1.0000E-01, Ks0 =  -1.6583E-04, Kn0 =   1.6639E-05,
   Kn1 =   3.0000E-01, Kn2 =   3.0000E+00, En0 =  -2.0000E+03, Es1 =   6.6667E+03, x_offset =   5.0000E-02,
   x_rot =   1.0000E-03)
  rbend4 = SBend(bend_type = rbend, L_chord =   6.0000E-01, e1_rect =   1.0000E-01,
   e2_rect =   2.0000E-01, g_ref =   1.0000E-02, tilt_ref =   1.0000E-01, Ks0 =  -1.6483E-04,
   Kn0 =   6.7833E-03, Ks1 =   5.0000E-06, En0 =  -2.0000E+03, Es1 =   6.6667E+03, x_offset =   5.0000E-02,
   x_rot =   1.0000E-03)
  sbend5 = SBend(L =   6.0000E-01, e1 =   1.0000E-01, e2 =   2.0000E-01, g_ref =   1.0000E-02,
   tilt_ref =   1.0000E-01, Ks0 =  -6.5834E-05, Kn0 =   1.6683E-02, Ks1 =   5.0000E-04, En0 =  -2.0000E+03,
   Es1 =   6.6667E+03, x_offset =   5.0000E-02, x_rot =   1.0000E-03)
  rbend6 = SBend(bend_type = rbend, L_chord =   6.0000E-01, e1_rect =   1.0000E-01,
   e2_rect =   2.0000E-01, g_ref =   1.0000E-02, tilt_ref =   1.0000E-01, Ks0 =  -1.6583E-04,
   Kn0 =   6.6834E-03, Ks1 =   5.0000E-09, En0 =  -2.0000E+03, Es1 =   6.6667E+03, x_offset =   5.0000E-02,
   x_rot =   1.0000E-03)
  sbend7 = SBend(L =   6.0000E-01, e1 =   1.0000E-01, e2 =   2.0000E-01, g_ref =   1.0000E-02,
   tilt_ref =   1.0000E-01, Ks0 =  -6.5834E-05, Kn0 =   1.6683E-02, Ks1 =   5.0000E-04, En0 =  -2.0000E+03,
   Es1 =   6.6667E+03, x_offset =   5.0000E-02, x_rot =   1.0000E-03)
  sextupole1 = Sextupole(L =   6.0000E-01, Kn2 =   1.0000E+00, x_offset =   5.0000E-02,
   x_rot =   1.0000E-03, z_rot =   5.2360E-01)
  solenoid1 = Solenoid(L =   2.6000E+00, x_offset =   5.0000E-02, x_rot =   1.0000E-03,
   z_rot =   1.0000E-01, ksol =   1.0000E+00)
  solenoid2 = Solenoid(L =   2.6000E+00, x_offset =   5.0000E-02, x_rot =   1.0000E-03,
   z_rot =   1.0000E-01, ksol =   1.0000E-12)
  sol_quad1 = Solenoid(L =   2.6000E+00, Kn1 =   1.0000E+00, x_offset =   5.0000E-02,
   x_rot =   1.0000E-03, z_rot =   1.0000E-01, ksol =   1.0000E+00)
  sol_quad2 = Solenoid(L =   2.6000E+00, Kn1 =   1.0000E-05, x_offset =   5.0000E-02,
   x_rot =   1.0000E-03, z_rot =   1.0000E-01, ksol =   1.0000E+00)
  thick_multipole1 = ThickMultipole(L =   4.5000E+00, Ks2 =   4.4444E-01, Kn3 =   2.6667E+01,
   x_offset =   2.0000E-02, z_rot =   1.0000E-01)
  taylor1 = LineElement(L =   5.0000E-01, transport_map = map_taylor1)
  vkicker1 = Kicker(L =   4.5000E+00, Ks0 =   1.1111E-03, x_offset =   5.0000E-02, x_rot =   1.0000E-03,
   z_rot =   1.0000E-01)
  lcavity1 = RFCavity(L =   4.5000E+00, x_offset =   5.0000E-02, x_rot =   1.0000E-03,
   z_rot =   1.0000E-01, rf_frequency =   5.0000E+08, voltage =   5.0000E+03, phi0 =  -1.9000E-01)
  lcavity2 = RFCavity(L =   4.5000E+00, x_offset =   5.0000E-02, x_rot =   1.0000E-03,
   z_rot =   1.0000E-01, rf_frequency =   5.0000E+08, voltage =   5.0000E+00, phi0 =  -1.9000E-01)
  lcavity3 = RFCavity(L =   4.5000E+00, x_offset =   5.0000E-02, x_rot =   1.0000E-03,
   z_rot =   1.0000E-01, rf_frequency =   5.0000E+08, voltage =   5.0450E+03, phi0 =  -1.9000E-01)
  end_b0 = Marker()
end    # @eles

l1 = Beamline([ ab_multipole1, ac_kicker0123456789, ac_kicker0123456789, ac_kicker2, beambeam1,
   crab_cavity1, ecollimator1, elseparator1, elseparator2, em_field1, em_field2, fiducial1, floor_shift1,
   gkicker1, hkicker1, instrument1, kicker1, match1, monitor1, multipole1, octupole1, patch1, quadrupole1,
   quadrupole2, quadrupole3, quadrupole4, quadrupole5, rcollimator1, rfcavity1, rfcavity2, rfcavity3,
   sad_mult1, sad_mult2, sbend1, rbend2, sbend3, rbend4, sbend5, rbend6, sbend7, sextupole1, solenoid1,
   solenoid2, sol_quad1, sol_quad2, thick_multipole1, taylor1, vkicker1, lcavity1, lcavity2, lcavity3,
   end_b0]; pc_ref =   8.5958E+05, species_ref = Species("positron"))
